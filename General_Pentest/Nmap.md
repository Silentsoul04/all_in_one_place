Nmap

## Cheat sheet

### Target

```
nmap <ip>
nmap <network/<cidr>
nmap 10.10.10.1-255
```

### Ping sweep 

Check if host is alive
```nmap -sn <ip>```

### Scan targets from a file

```nmap -iL <file>```

### Version

- You can set how intense you want the probes to be from 0 (light probe, fast but not accurate) to 9 (try all probes, slow but accurate)

```nmap -sV - version-intensity 9```

### Output Formats

```
all : -oA. Very useful to resume interrupted scan : nmap â€“resume logfile_name
Normal : -oN
XML : -oX
script kiddie : -oS
greppage : -oG
```

### Ports 

**Specific tcp and udp** 

```nmap -sU -pT:21,22,23,U:53,137 192.168.10.0/24```

**All ports**

```nmap -p-```

**Some**

```nmap -p22,23,50-60```

### Scripts

**Common NSE scripts**
```nmap -sC```
**specific script***
```nmap --script=<nse script>```
**pass argument for the script**
```script-args=n1=v1,n2=v2```
**Script help**
```nmap --script-help=scriptname```



### OS Discovery

```nmap -O```


### Special TCP Scan

- The FIN scan sends a TCP packet with only the FIN (finish) bit set. 
- The XMAS scan sends a TCP packet with the FIN, URG, and PSH flags. 
- - The ACK scan sends a TCP packet with only the ACK flag set. 
- The NULL scan, as can be expected, sends a packet with no TCP options set at all.

```
FIN Scan : nmap -sF host

XMAS Scan : nmap -sX host

ACK Scan : nmap -sA host

NULL Scan nmap -sN host

```

### Scan Speed

- 0 low, 5 fast :

```nmap -T0```

- Make sure that you have a good bandwith and so the host you are targeting.


---

https://medium.com/@hakluke/haklukes-guide-to-nmap-port-scanning-is-just-the-beginning-25d971692fdb

https://danielmiessler.com/study/nmap/
