Tips

## Command injection

- Code injection should be in the language used by the application. Therefore, the first step in an injection is to find what language is used by the application. To do so you can look at the response's headers, generate errors or look at the way special characters are handle by the application (for example by comparing `+` and `.` for concatenation of strings, or `"` and `'` ...)

```
command1 && command2 that will run command2 if command1 succeeds.
command1 || command2 that will run command2 if command1 fails.
command1 ; command2 that will run command1 then command2.
command1 | command2 that will run command1 and send the output of command1 to command2.
try to use backticks directly : `` or after the first one
try to use $(command2) directly, or after the first one
try url encode, " and ' etc
try a new line (0x0a or \n)

```

- If some characters are blocked, try to encode it (base64 for example) and decode it inside the payload.

- Try with the man ascii to use the # to comment the end of the payload if it's a linux, and then do your tests with etc, passwd, /etc/passwd (maybe some of them are blocked)

---

## Curl

- `--path-as-is` to directory traversal . Without it, it doesn't work.

- Use proxy : `curl -s -U <user>:<pass> -x <ip_proxy>:<port_proxy> <url>`

---

## Reverse shell blocked on linux ?

- See if `iptables` or `ufw` are enabled, and if you can, show the rules. 
- It's also possible that it blocks only on the name of the application trying to reverse shell, so try copy `/bin/bash` in `/dev/shm/<name_it_like_you_want>` and do it again.

---

## Problem with output

When something doesn't appear after trying to execute a payload on a website, try use ```2>&1``` at the end

To test it locally, if you enter ```nc -h >/dev/null``` and you doesn't see output, it's because the output is in standard error (stderr). By default it prints standard ouput (stdout).

---

## Checking ip tables rules

- `/etc/iptables/rules.v4` for IPv4 rules.

---

## Git files

- Dump a git repository from a website : git-dumper. 

https://blog.netspi.com/dumping-git-data-from-misconfigured-web-servers/

---

## jar files :

https://v3ded.github.io/ctf/htb-blocky.html

---

## Keepass

.kbdx file => keepass
https://v3ded.github.io/ctf/htb-jeeves.html

---

## Port Knocking

https://v3ded.github.io/ctf/htb-nineveh.html

---

## Full tty

[*] To upgrade to fully interactive tty:

- Identify rows and columns :
```
stty -a
```
Then
```
python -c 'import pty;pty.spawn("/bin/bash")'
```
OR
```SHELL=/bin/bash script -q /dev/null```
OR
```expect -c 'spawn bash; interact'```
THEN
```
CTRL-Z
stty raw -echo
fg
reset
export SHELL=bash 
export TERM=xterm-256color 
stty rows <rowss> columns <columns>
clear
```

- ```SHELL``` and ```TERM``` depends on your environment, do not forget to change it if needed.

---


## Symbolic link (because I forgot it every time)

``` ln -s <file you want to link> <your file>```


---

## Understand how a custom program work 

- ltrace

--- 

## Foud a dump file or dmp or db or ... ?

- ```file``` it to check what you can do.

---

## What to do when you have credentials

- Try login with ssh, or every services you have found where there is an authentication needed.

- If you have a cmd with one but not with the other, try to connect with one, and then switch the user

- copy ssh keys

---

## Cross compilations

- Install ```mingw-w64*```

- Then compile your file (example) : ```i686-w64-mingw32-gcc sl_mail_windows.c -lws2_32 -o slmail-fixed-windows.exe```

- If cpp => g++ at the end.

---

## Bypass web authorization with headers :

- Some example : 
```
Host:
X-Forwarded-For: 
```

- Use ZAProxy or burp to fuzz headers

---

## Bypass AV / WAF


https://github.com/Veil-Framework/Veil

---

## Pull TLS information from a website (certificate issue)

- ```sslyze --regular <ip>```
or
- ```openssl s_client -connect <ip>:443```
- ```echo | openssl s_client -showcerts -servername <ip> -connect <ip>:443 2>/dev/null | openssl x509 -inform pem -noout -text```

---

## Check if WAF is installed

```wafw00f```

---

## Scan Wordpress

- ```WPScan```

- wordpress enum and how to fix it : https://medium.com/@ahmed_elhady/wordpress-username-enumeration-techniques-2ca0510df632

--

## Log what you did and when 

- Add this to your .bashrc file:

```
PS1='[`date  +"%d-%b-%y %T"`] > ' 
test "$(ps -ocommand= -p $PPID | awk '{print $1}')" == 'script' || (script -f $HOME/logs/$(date +"%d-%b-%y_%H-%M-%S")_shell.log)
```

---

## CVE with POC

- https://www.cvebase.com/cve/pocs?fbclid=IwAR2DRpHzOari3JvI9YwAgIs9nfyPbMOYe55KOY7nKGHNQT8f3YAEW1S4b6Q

---

## adm group or user

On linux, able to read log files.









